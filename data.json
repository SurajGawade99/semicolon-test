{
  "classes": [
    {
      "name": "BaseListFindings",
      "functions": [
        {
          "name": "__init__",
          "start_line": 264,
          "end_line": 278
        },
        {
          "name": "get_filter_name",
          "start_line": 280,
          "end_line": 283
        },
        {
          "name": "get_order_by",
          "start_line": 285,
          "end_line": 288
        },
        {
          "name": "get_prefetch_type",
          "start_line": 290,
          "end_line": 293
        },
        {
          "name": "get_product_id",
          "start_line": 295,
          "end_line": 298
        },
        {
          "name": "get_engagement_id",
          "start_line": 300,
          "end_line": 303
        },
        {
          "name": "get_test_id",
          "start_line": 305,
          "end_line": 308
        },
        {
          "name": "filter_findings_by_object",
          "start_line": 310,
          "end_line": 318
        },
        {
          "name": "filter_findings_by_filter_name",
          "start_line": 320,
          "end_line": 337
        },
        {
          "name": "filter_findings_by_form",
          "start_line": 339,
          "end_line": 352
        },
        {
          "name": "get_filtered_findings",
          "start_line": 354,
          "end_line": 359
        },
        {
          "name": "get_fully_filtered_findings",
          "start_line": 361,
          "end_line": 363
        }
      ]
    },
    {
      "name": "ListFindings",
      "functions": [
        {
          "name": "get_initial_context",
          "start_line": 367,
          "end_line": 397
        },
        {
          "name": "get_template",
          "start_line": 399,
          "end_line": 400
        },
        {
          "name": "add_breadcrumbs",
          "start_line": 402,
          "end_line": 420
        },
        {
          "name": "get",
          "start_line": 422,
          "end_line": 444
        }
      ]
    },
    {
      "name": "ListOpenFindings",
      "functions": [
        {
          "name": "get",
          "start_line": 448,
          "end_line": 450
        }
      ]
    },
    {
      "name": "ListVerifiedFindings",
      "functions": [
        {
          "name": "get",
          "start_line": 454,
          "end_line": 456
        }
      ]
    },
    {
      "name": "ListOutOfScopeFindings",
      "functions": [
        {
          "name": "get",
          "start_line": 460,
          "end_line": 462
        }
      ]
    },
    {
      "name": "ListFalsePositiveFindings",
      "functions": [
        {
          "name": "get",
          "start_line": 466,
          "end_line": 468
        }
      ]
    },
    {
      "name": "ListInactiveFindings",
      "functions": [
        {
          "name": "get",
          "start_line": 472,
          "end_line": 474
        }
      ]
    },
    {
      "name": "ListAcceptedFindings",
      "functions": [
        {
          "name": "get",
          "start_line": 478,
          "end_line": 480
        }
      ]
    },
    {
      "name": "ListClosedFindings",
      "functions": [
        {
          "name": "get",
          "start_line": 484,
          "end_line": 487
        }
      ]
    },
    {
      "name": "ViewFinding",
      "functions": [
        {
          "name": "get_finding",
          "start_line": 491,
          "end_line": 493
        },
        {
          "name": "get_dojo_user",
          "start_line": 495,
          "end_line": 497
        },
        {
          "name": "get_previous_and_next_findings",
          "start_line": 499,
          "end_line": 525
        },
        {
          "name": "get_credential_objects",
          "start_line": 527,
          "end_line": 548
        },
        {
          "name": "get_cwe_template",
          "start_line": 550,
          "end_line": 557
        },
        {
          "name": "get_request_response",
          "start_line": 559,
          "end_line": 574
        },
        {
          "name": "get_test_import_data",
          "start_line": 576,
          "end_line": 596
        },
        {
          "name": "get_similar_findings",
          "start_line": 598,
          "end_line": 636
        },
        {
          "name": "get_jira_data",
          "start_line": 638,
          "end_line": 651
        },
        {
          "name": "get_note_form",
          "start_line": 653,
          "end_line": 659
        },
        {
          "name": "get_typed_note_form",
          "start_line": 661,
          "end_line": 669
        },
        {
          "name": "get_form",
          "start_line": 671,
          "end_line": 676
        },
        {
          "name": "process_form",
          "start_line": 678,
          "end_line": 714
        },
        {
          "name": "get_initial_context",
          "start_line": 716,
          "end_line": 739
        },
        {
          "name": "get_template",
          "start_line": 741,
          "end_line": 742
        },
        {
          "name": "get",
          "start_line": 744,
          "end_line": 762
        },
        {
          "name": "post",
          "start_line": 764,
          "end_line": 785
        }
      ]
    },
    {
      "name": "EditFinding",
      "functions": [
        {
          "name": "get_finding",
          "start_line": 789,
          "end_line": 790
        },
        {
          "name": "get_request_response",
          "start_line": 792,
          "end_line": 797
        },
        {
          "name": "get_finding_form",
          "start_line": 799,
          "end_line": 812
        },
        {
          "name": "get_jira_form",
          "start_line": 814,
          "end_line": 831
        },
        {
          "name": "get_github_form",
          "start_line": 833,
          "end_line": 848
        },
        {
          "name": "get_initial_context",
          "start_line": 850,
          "end_line": 862
        },
        {
          "name": "validate_status_change",
          "start_line": 864,
          "end_line": 901
        },
        {
          "name": "process_mitigated_data",
          "start_line": 903,
          "end_line": 923
        },
        {
          "name": "process_false_positive_history",
          "start_line": 925,
          "end_line": 944
        },
        {
          "name": "process_burp_request_response",
          "start_line": 946,
          "end_line": 959
        },
        {
          "name": "process_finding_form",
          "start_line": 961,
          "end_line": 1007
        },
        {
          "name": "process_jira_form",
          "start_line": 1009,
          "end_line": 1063
        },
        {
          "name": "process_github_form",
          "start_line": 1065,
          "end_line": 1079
        },
        {
          "name": "process_forms",
          "start_line": 1081,
          "end_line": 1111
        },
        {
          "name": "get_template",
          "start_line": 1113,
          "end_line": 1114
        },
        {
          "name": "get",
          "start_line": 1116,
          "end_line": 1124
        },
        {
          "name": "post",
          "start_line": 1126,
          "end_line": 1139
        }
      ]
    },
    {
      "name": "DeleteFinding",
      "functions": [
        {
          "name": "get_finding",
          "start_line": 1143,
          "end_line": 1144
        },
        {
          "name": "process_form",
          "start_line": 1146,
          "end_line": 1180
        },
        {
          "name": "post",
          "start_line": 1182,
          "end_line": 1196
        }
      ]
    }
  ],
  "functions_not_in_class": [
    {
      "name": "prefetch_for_findings",
      "start_line": 133,
      "end_line": 211
    },
    {
      "name": "prefetch_for_similar_findings",
      "start_line": 214,
      "end_line": 260
    },
    {
      "name": "close_finding",
      "start_line": 1200,
      "end_line": 1309
    },
    {
      "name": "defect_finding_review",
      "start_line": 1313,
      "end_line": 1394
    },
    {
      "name": "reopen_finding",
      "start_line": 1402,
      "end_line": 1450
    },
    {
      "name": "apply_template_cwe",
      "start_line": 1454,
      "end_line": 1476
    },
    {
      "name": "copy_finding",
      "start_line": 1480,
      "end_line": 1535
    },
    {
      "name": "remediation_date",
      "start_line": 1539,
      "end_line": 1572
    },
    {
      "name": "touch_finding",
      "start_line": 1576,
      "end_line": 1583
    },
    {
      "name": "simple_risk_accept",
      "start_line": 1587,
      "end_line": 1601
    },
    {
      "name": "risk_unaccept",
      "start_line": 1605,
      "end_line": 1618
    },
    {
      "name": "request_finding_review",
      "start_line": 1622,
      "end_line": 1707
    },
    {
      "name": "clear_finding_review",
      "start_line": 1711,
      "end_line": 1783
    },
    {
      "name": "mktemplate",
      "start_line": 1787,
      "end_line": 1827
    },
    {
      "name": "find_template_to_apply",
      "start_line": 1831,
      "end_line": 1884
    },
    {
      "name": "choose_finding_template_options",
      "start_line": 1888,
      "end_line": 1912
    },
    {
      "name": "apply_template_to_finding",
      "start_line": 1916,
      "end_line": 1968
    },
    {
      "name": "add_stub_finding",
      "start_line": 1972,
      "end_line": 2009
    },
    {
      "name": "delete_stub_finding",
      "start_line": 2013,
      "end_line": 2036
    },
    {
      "name": "promote_to_finding",
      "start_line": 2040,
      "end_line": 2192
    },
    {
      "name": "templates",
      "start_line": 2196,
      "end_line": 2212
    },
    {
      "name": "export_templates_to_json",
      "start_line": 2216,
      "end_line": 2218
    },
    {
      "name": "apply_cwe_mitigation",
      "start_line": 2221,
      "end_line": 2288
    },
    {
      "name": "add_template",
      "start_line": 2292,
      "end_line": 2332
    },
    {
      "name": "edit_template",
      "start_line": 2336,
      "end_line": 2396
    },
    {
      "name": "delete_template",
      "start_line": 2400,
      "end_line": 2421
    },
    {
      "name": "download_finding_pic",
      "start_line": 2424,
      "end_line": 2482
    },
    {
      "name": "merge_finding_product",
      "start_line": 2486,
      "end_line": 2680
    },
    {
      "name": "finding_bulk_update_all",
      "start_line": 2684,
      "end_line": 3123
    },
    {
      "name": "find_available_notetypes",
      "start_line": 3126,
      "end_line": 3143
    },
    {
      "name": "get_missing_mandatory_notetypes",
      "start_line": 3146,
      "end_line": 3159
    },
    {
      "name": "mark_finding_duplicate",
      "start_line": 3164,
      "end_line": 3206
    },
    {
      "name": "reset_finding_duplicate_status_internal",
      "start_line": 3209,
      "end_line": 3225
    },
    {
      "name": "reset_finding_duplicate_status",
      "start_line": 3230,
      "end_line": 3247
    },
    {
      "name": "set_finding_as_original_internal",
      "start_line": 3250,
      "end_line": 3304
    },
    {
      "name": "set_finding_as_original",
      "start_line": 3309,
      "end_line": 3324
    },
    {
      "name": "unlink_jira",
      "start_line": 3329,
      "end_line": 3360
    },
    {
      "name": "push_to_jira",
      "start_line": 3365,
      "end_line": 3401
    },
    {
      "name": "duplicate_cluster",
      "start_line": 3405,
      "end_line": 3418
    },
    {
      "name": "calculate_possible_related_actions_for_similar_finding",
      "start_line": 3426,
      "end_line": 3524
    }
  ],
  "code_not_in_class": [
    {
      "start_line": 2,
      "end_line": 130,
      "content": "import base64\nimport json\nimport logging\nimport mimetypes\nimport contextlib\nfrom collections import OrderedDict, defaultdict\nfrom django.db import models\nfrom django.db.models.functions import Length\nfrom django.conf import settings\nfrom django.contrib import messages\nfrom django.core.exceptions import PermissionDenied, ValidationError\nfrom django.core import serializers\nfrom django.urls import reverse\nfrom django.http import Http404, HttpResponse, JsonResponse, HttpRequest\nfrom django.http import HttpResponseRedirect\nfrom django.http import StreamingHttpResponse\nfrom django.shortcuts import render, get_object_or_404\nfrom django.utils import formats\nfrom django.utils.safestring import mark_safe\nfrom django.utils import timezone\nfrom django.views.decorators.http import require_POST\nfrom django.views import View\nfrom itertools import chain\nfrom imagekit import ImageSpec\nfrom imagekit.processors import ResizeToFill\nfrom dojo.utils import (\n    add_error_message_to_response,\n    add_field_errors_to_response,\n    add_success_message_to_response,\n    close_external_issue,\n    redirect,\n    reopen_external_issue,\n    do_false_positive_history,\n    match_finding_to_existing_findings,\n    get_page_items_and_count,\n)\nimport copy\nfrom dojo.filters import (\n    TemplateFindingFilter,\n    SimilarFindingFilter,\n    FindingFilter,\n    AcceptedFindingFilter,\n    TestImportFindingActionFilter,\n    TestImportFilter,\n)\nfrom dojo.forms import (\n    EditPlannedRemediationDateFindingForm,\n    NoteForm,\n    TypedNoteForm,\n    CloseFindingForm,\n    FindingForm,\n    PromoteFindingForm,\n    FindingTemplateForm,\n    DeleteFindingTemplateForm,\n    JIRAFindingForm,\n    GITHUBFindingForm,\n    ReviewFindingForm,\n    ClearFindingReviewForm,\n    DefectFindingForm,\n    StubFindingForm,\n    DeleteFindingForm,\n    DeleteStubFindingForm,\n    ApplyFindingTemplateForm,\n    FindingFormID,\n    FindingBulkUpdateForm,\n    MergeFindings,\n    CopyFindingForm,\n)\nfrom dojo.models import (\n    IMPORT_UNTOUCHED_FINDING,\n    Finding,\n    Finding_Group,\n    Notes,\n    NoteHistory,\n    Note_Type,\n    BurpRawRequestResponse,\n    Stub_Finding,\n    Endpoint,\n    Finding_Template,\n    Endpoint_Status,\n    FileAccessToken,\n    GITHUB_PKey,\n    GITHUB_Issue,\n    Dojo_User,\n    Cred_Mapping,\n    Test,\n    Product,\n    Test_Import,\n    Test_Import_Finding_Action,\n    User,\n    Engagement,\n    Vulnerability_Id_Template,\n    System_Settings,\n)\nfrom dojo.utils import (\n    get_page_items,\n    add_breadcrumb,\n    FileIterWrapper,\n    process_notifications,\n    get_system_setting,\n    apply_cwe_to_template,\n    Product_Tab,\n    calculate_grade,\n    redirect_to_return_url_or_else,\n    get_return_url,\n    add_external_issue,\n    update_external_issue,\n    get_words_for_field,\n)\nfrom dojo.notifications.helper import create_notification\n\nfrom django.template.defaultfilters import pluralize\nfrom django.db.models import Q, QuerySet, Count\nfrom django.db.models.query import Prefetch\nimport dojo.jira_link.helper as jira_helper\nimport dojo.risk_acceptance.helper as ra_helper\nimport dojo.finding.helper as finding_helper\nfrom dojo.authorization.authorization import user_has_permission_or_403\nfrom dojo.authorization.authorization_decorators import (\n    user_is_authorized,\n    user_has_global_permission,\n)\nfrom dojo.authorization.roles_permissions import Permissions\nfrom dojo.finding.queries import get_authorized_findings\nfrom dojo.test.queries import get_authorized_tests\n\nJFORM_PUSH_TO_JIRA_MESSAGE = \"jform.push_to_jira: %s\"\n\nlogger = logging.getLogger(__name__)"
    }
  ]
}
